***

#### 理论



***

#### 代码

```cpp
int kmp(const string& text,const string& pattern) 
{	
    //计算前缀表
	vector<int> prefix(pattern.size(), 0);	//前缀表初始化0
	for (int j = 0, i = 1; i < pattern.size(); ++i)	//i指向后缀尾，j指向前缀尾
    {
        //回退直到退回起始位置，或者找到匹配项
        while (j > 0 && pattern[i] != pattern[j])
			j = prefix[j - 1];
		if (pattern[i] == pattern[j])
			prefix[i] = ++j;
	}
    
    //计算下标
    for (int i = 0, j = 0; i < text.length(); ++i)	//i遍历文本串，j遍历模式串 
    {
        //回退直到退回起始位置，或者找到匹配项
        while (j > 0 && text[i] != pattern[j])
            j = prefix[j - 1];
        //当模式串剩余长度大于文本串时，无需再匹配
        if (pattern.length() - j > text.length() - i)
            return -1;
        if (text[i] == pattern[j])
            ++j;
        if (i == text.length())
            return i - pattern.length() + 1;
    }
	return -1;

}
```

