图像直方图是对图像中像素值信息的统计特征。

使用`calcHist(imgs, imgs_count, channels, mask, hist, dims, hist_size, ranges)`计算直方图。

1. `imgs`，图像数组。
2. `imgs_count`，图像数量。
3. `channels`，指明用于计算的图像通道，第一张图的通道值为`0~imgs[0].channels`，第二张图的通道值为`imgs[0].channels ~ imgs[0].channels + imgs[1].channels - 1`，依此类推。
4. `mask`，遮罩图。
5. `hist`，输出的直方图数据。
6. `dims`，直方图的维度。
7. `hist_size`，直方图数据中每个维度的区块数量，`int*`。
8. `ranges`，各个图像统计的范围，`float**`。

在计算直方图数据时，得到的是像素出现的频次，在绘制时，需要的是沿y轴从下往上增长的图片，所以频次和绘制点的坐标并不相同。

```cpp
// 直方图尺寸
const int HIST_HEIGHT = 800;
const int HIST_WIDTH = 256 * 5;

// 颜色
const cv::Scalar RED{0, 0, 255};
const cv::Scalar GREEN{0, 255, 0};
const cv::Scalar BLUE{255, 0, 0};

void showHist(cv::Mat img)
{
	// 分离三通道
	std::vector<cv::Mat> bgr;
	cv::split(img, bgr);

	// 准备参数
	int channels[] = {0};
	int hist_size[] = {256};
	float range[] = {0, 255};
	const float *ranges[] = {range};

	// 计算RGB三个通道的直方图数据
	cv::Mat hist_r, hist_g, hist_b;
	cv::calcHist(&bgr[0], 1, channels, cv::Mat(), hist_b, 1, hist_size, ranges);
	cv::calcHist(&bgr[1], 1, channels, cv::Mat(), hist_g, 1, hist_size, ranges);
	cv::calcHist(&bgr[2], 1, channels, cv::Mat(), hist_r, 1, hist_size, ranges);

	// 归一化数据
	cv::normalize(hist_b, hist_b, 0, HIST_HEIGHT, cv::NORM_MINMAX);
	cv::normalize(hist_g, hist_g, 0, HIST_HEIGHT, cv::NORM_MINMAX);
	cv::normalize(hist_r, hist_r, 0, HIST_HEIGHT, cv::NORM_MINMAX);

	// 绘制直方图
	cv::Mat hist_img{cv::Size(HIST_WIDTH, HIST_HEIGHT), CV_8UC3};
	for (int i = 1; i < 256; ++i)
	{
		// RED
		cv::line(hist_img, cv::Point(HIST_WIDTH / 255 * (i - 1), HIST_HEIGHT - (int)hist_r.at<float>(i - 1)),
				 cv::Point(HIST_WIDTH / 255 * i, HIST_HEIGHT - (int)hist_r.at<float>(i)), RED, 1, cv::LINE_AA);
		// GREEN
		cv::line(hist_img, cv::Point(HIST_WIDTH / 255 * (i - 1), HIST_HEIGHT - (int)hist_g.at<float>(i - 1)),
				 cv::Point(HIST_WIDTH / 255 * i, HIST_HEIGHT - (int)hist_g.at<float>(i)), GREEN, 1, cv::LINE_AA);
		// BLUE
		cv::line(hist_img, cv::Point(HIST_WIDTH / 255 * (i - 1), HIST_HEIGHT - (int)hist_b.at<float>(i - 1)),
				 cv::Point(HIST_WIDTH / 255 * i, HIST_HEIGHT - (int)hist_b.at<float>(i)), BLUE, 1, cv::LINE_AA);
	}

	// 显示直方图
	cv::imshow("hist", hist_img);
}

```



