c++20引入`std::format(format_str, args)`生成格式化字符。

在格式字符串中，使用`{ <index> <:spec> }`表示替换字段。

* `index`显示指定替换替换字段在参数中的索引（索引从0开始计数）。`index`必须全部存在或忽略，不能使用混合模式。

* `spec`控制输出的对齐方式，其格式为`: <fill> <align> <sign> <#> <width> <prec> <align> <L> <type>`。在大多数情况下，其语法类似旧的%格式化，如`%3.2f`可替换为`{:3.2f}`。

  * fill表示对齐的填充字符。

  * align表示对齐方式，`<`、`>`、`^`分别表示左、右、中对齐。

  * sign表示格式化数值时符号。

    * "+"表示任何数均使用符号。
    * "-"表示只有负数使用符号。
    * " "表示正数使用前导空格，负数使用符号。

  * #表示输出16、8、2进制格式时，插入格式符号。

    ```cpp
    std::cout << std::format("{:x}", 0x1234);	// 1234
    std::cout << std::format("{:#x}", 0x1234);	// 0x1234
    ```

  * width表示格式化字段占据最小宽度，可使用`{:{}}`根据传入参数动态设置宽度。

  * prec表示精度，格式为`.非负十进制数`，其只能作用于浮点数或字符串。

    * 作用于浮点时，表示输出的精度（小数点后位数）。

    * 作用于字符串时，表示输出的最大宽度。

      ```cpp
      std::cout << std::format("'{:.2s}'\n", "hello");	// 'he'
      std::cout << std::format("'{:.10s}'\n", "hello");	// 'hello'
      ```

  * L表示对整数、浮点和布尔类型输出时，使用本地特定形式。

  * type表示格式字段的类型。

    * `b B o d x X`表示整数的不同进制。
    * `a A e E f g G`表示浮点的不同形式。
    * `c`表示字符。
    * `s`表示字符串。
    * `p`表示指针。

  > 如果需要表示"{xxx}"，使用`{{xxx}}`。

#### 字符串格式化

C++20引入了`format()`模板函数族，用于生成格式化字符串。

使用`{}`作为占位符，`{}`内可以是`[index][:specifier]`格式的字符串：

* `index`可忽略，用于指定格式化值的参数的下标，将按照顺序格式化参数。`index`必须全部存在或全部忽略，混合模式将报错。
* * 

> 如果需要输出`"{xxx}"`字符串，使用`"{{xxx}}"`转义。

对于类对象，`format()`通过`formatter<>`模板类来获取格式化方式。如果需要自定义类对象的格式化规则，需要实例`formatter<>`模板类。

```cpp
struct Person 
{
	std::string name;
	uint8_t age;
};

template<>
struct std::formatter<Person>
{
	// parse负责解析传入的格式化字符
	template<typename ParseContext>
	auto parse(ParseContext& context)
	{
		return context.begin();
	}

	// format负责格式化
	template<typename FormatContext>
	auto format(const Person& person, FormatContext& context)
	{
		return std::format_to(context.out(), "{} is {} years old",
			person.name, person.age);
	}
};

int main()
{
	Person person = { "name",20 };
	std::cout << std::format("{}\n", person);

	return 0;
}
```
